<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="net.hwyz.iov.cloud.tsp.vmd.service.infrastructure.repository.dao.PartDao">

    <!-- 通用查询映射结果 -->
    <resultMap id="baseResultMap" type="net.hwyz.iov.cloud.tsp.vmd.service.infrastructure.repository.po.PartPo">
        <id column="id" property="id" />
        <result column="description" property="description" />
        <result column="create_time" property="createTime" />
        <result column="create_by" property="createBy" />
        <result column="modify_time" property="modifyTime" />
        <result column="modify_by" property="modifyBy" />
        <result column="row_version" property="rowVersion" />
        <result column="row_valid" property="rowValid" />
        <result column="pn" property="pn" />
        <result column="name" property="name" />
        <result column="name_en" property="nameEn" />
        <result column="type" property="type" />
        <result column="ffa" property="ffa" />
        <result column="status" property="status" />
        <result column="digital_model" property="digitalModel" />
        <result column="unit" property="unit" />
        <result column="frame_part" property="framePart" />
        <result column="nature_part" property="naturePart" />
        <result column="color_area" property="colorArea" />
        <result column="nature_pn" property="naturePn" />
        <result column="regulatory_part" property="regulatoryPart" />
        <result column="key_part" property="keyPart" />
        <result column="accurately_traced" property="accuratelyTraced" />
        <result column="aftersale_part" property="aftersalePart" />
        <result column="standard_part_class" property="standardPartClass" />
        <result column="wrench_type" property="wrenchType" />
        <result column="rod_type" property="rodType" />
        <result column="head_shape" property="headShape" />
        <result column="end_shape" property="endShape" />
        <result column="washer" property="washer" />
        <result column="washer_type" property="washerType" />
        <result column="diameter" property="diameter" />
        <result column="length" property="length" />
        <result column="pitch" property="pitch" />
        <result column="dental_form" property="dentalForm" />
        <result column="strength_grade" property="strengthGrade" />
        <result column="mechanical_property" property="mechanicalProperty" />
        <result column="surface_treatment" property="surfaceTreatment" />
        <result column="structure_character" property="structureCharacter" />
        <result column="device_form" property="deviceForm" />
        <result column="device_code" property="deviceCode" />
        <result column="designer" property="designer" />
        <result column="designer_dept" property="designerDept" />
        <result column="non_repair_reason" property="nonRepairReason" />
        <result column="color_repair" property="colorRepair" />
        <result column="primer_repair" property="primerRepair" />
        <result column="electrophoresis_repair" property="electrophoresisRepair" />
        <result column="production_code" property="productionCode" />
        <result column="spare_property" property="spareProperty" />
        <result column="sale_note" property="saleNote" />
        <result column="first_production_date" property="firstProductionDate" />
        <result column="initial_model" property="initialModel" />
    </resultMap>

    <!-- 通用查询结果列 -->
    <sql id="baseColumnList">
        id, pn, name, name_en, type, ffa, status, digital_model, unit, frame_part, nature_part, color_area, nature_pn, regulatory_part, key_part, accurately_traced, aftersale_part, standard_part_class, wrench_type, rod_type, head_shape, end_shape, washer, washer_type, diameter, length, pitch, dental_form, strength_grade, mechanical_property, surface_treatment, structure_character, device_form, device_code, designer, designer_dept, non_repair_reason, color_repair, primer_repair, electrophoresis_repair, production_code, spare_property, sale_note, first_production_date, initial_model, 
        description, create_time, create_by, modify_time, modify_by, row_version, row_valid
    </sql>

    <!-- 插入 -->
    <insert id="insertPo" useGeneratedKeys="true" keyProperty="id">
        INSERT INTO tb_part (
            id, pn, name, name_en, type, ffa, status, digital_model, unit, frame_part, nature_part, color_area, nature_pn, regulatory_part, key_part, accurately_traced, aftersale_part, standard_part_class, wrench_type, rod_type, head_shape, end_shape, washer, washer_type, diameter, length, pitch, dental_form, strength_grade, mechanical_property, surface_treatment, structure_character, device_form, device_code, designer, designer_dept, non_repair_reason, color_repair, primer_repair, electrophoresis_repair, production_code, spare_property, sale_note, first_production_date, initial_model, 
            description, create_time, create_by, modify_time, modify_by, row_version, row_valid
        )
        VALUES (
            #{id}, #{pn}, #{name}, #{nameEn}, #{type}, #{ffa}, #{status}, #{digitalModel}, #{unit}, #{framePart}, #{naturePart}, #{colorArea}, #{naturePn}, #{regulatoryPart}, #{keyPart}, #{accuratelyTraced}, #{aftersalePart}, #{standardPartClass}, #{wrenchType}, #{rodType}, #{headShape}, #{endShape}, #{washer}, #{washerType}, #{diameter}, #{length}, #{pitch}, #{dentalForm}, #{strengthGrade}, #{mechanicalProperty}, #{surfaceTreatment}, #{structureCharacter}, #{deviceForm}, #{deviceCode}, #{designer}, #{designerDept}, #{nonRepairReason}, #{colorRepair}, #{primerRepair}, #{electrophoresisRepair}, #{productionCode}, #{spareProperty}, #{saleNote}, #{firstProductionDate}, #{initialModel}, 
            #{description}, now(), #{createBy}, now(), #{modifyBy}, 1, 1
        )
    </insert>

    <!-- 批量插入 -->
    <insert id="batchInsertPo" useGeneratedKeys="true" keyProperty="id" parameterType="java.util.List">
        INSERT INTO tb_part (
            id, pn, name, name_en, type, ffa, status, digital_model, unit, frame_part, nature_part, color_area, nature_pn, regulatory_part, key_part, accurately_traced, aftersale_part, standard_part_class, wrench_type, rod_type, head_shape, end_shape, washer, washer_type, diameter, length, pitch, dental_form, strength_grade, mechanical_property, surface_treatment, structure_character, device_form, device_code, designer, designer_dept, non_repair_reason, color_repair, primer_repair, electrophoresis_repair, production_code, spare_property, sale_note, first_production_date, initial_model, 
            description, create_time, create_by, modify_time, modify_by, row_version, row_valid
        )
        VALUES
        <foreach collection="list" item="item" index="index" separator=",">
        (
            #{item.id}, #{item.pn}, #{item.name}, #{item.nameEn}, #{item.type}, #{item.ffa}, #{item.status}, #{item.digitalModel}, #{item.unit}, #{item.framePart}, #{item.naturePart}, #{item.colorArea}, #{item.naturePn}, #{item.regulatoryPart}, #{item.keyPart}, #{item.accuratelyTraced}, #{item.aftersalePart}, #{item.standardPartClass}, #{item.wrenchType}, #{item.rodType}, #{item.headShape}, #{item.endShape}, #{item.washer}, #{item.washerType}, #{item.diameter}, #{item.length}, #{item.pitch}, #{item.dentalForm}, #{item.strengthGrade}, #{item.mechanicalProperty}, #{item.surfaceTreatment}, #{item.structureCharacter}, #{item.deviceForm}, #{item.deviceCode}, #{item.designer}, #{item.designerDept}, #{item.nonRepairReason}, #{item.colorRepair}, #{item.primerRepair}, #{item.electrophoresisRepair}, #{item.productionCode}, #{item.spareProperty}, #{item.saleNote}, #{item.firstProductionDate}, #{item.initialModel}, 
            #{item.description}, now(), #{item.createBy}, now(), #{item.modifyBy}, 1, 1
        )
        </foreach>
    </insert>

    <!-- 更新 -->
    <update id="updatePo" parameterType="net.hwyz.iov.cloud.tsp.vmd.service.infrastructure.repository.po.PartPo">
        UPDATE tb_part t SET
        <if test="pn != null and pn != ''">
            t.pn = #{pn},
        </if>
        <if test="name != null and name != ''">
            t.name = #{name},
        </if>
        <if test="nameEn != null and nameEn != ''">
            t.name_en = #{nameEn},
        </if>
        <if test="type != null and type != ''">
            t.type = #{type},
        </if>
        <if test="ffa != null and ffa != ''">
            t.ffa = #{ffa},
        </if>
        <if test="status != null and status != ''">
            t.status = #{status},
        </if>
        <if test="digitalModel != null and digitalModel != ''">
            t.digital_model = #{digitalModel},
        </if>
        <if test="unit != null and unit != ''">
            t.unit = #{unit},
        </if>
        <if test="framePart != null">
            t.frame_part = #{framePart},
        </if>
        <if test="naturePart != null">
            t.nature_part = #{naturePart},
        </if>
        <if test="colorArea != null and colorArea != ''">
            t.color_area = #{colorArea},
        </if>
        <if test="naturePn != null and naturePn != ''">
            t.nature_pn = #{naturePn},
        </if>
        <if test="regulatoryPart != null">
            t.regulatory_part = #{regulatoryPart},
        </if>
        <if test="keyPart != null and keyPart != ''">
            t.key_part = #{keyPart},
        </if>
        <if test="accuratelyTraced != null">
            t.accurately_traced = #{accuratelyTraced},
        </if>
        <if test="aftersalePart != null">
            t.aftersale_part = #{aftersalePart},
        </if>
        <if test="standardPartClass != null and standardPartClass != ''">
            t.standard_part_class = #{standardPartClass},
        </if>
        <if test="wrenchType != null and wrenchType != ''">
            t.wrench_type = #{wrenchType},
        </if>
        <if test="rodType != null and rodType != ''">
            t.rod_type = #{rodType},
        </if>
        <if test="headShape != null and headShape != ''">
            t.head_shape = #{headShape},
        </if>
        <if test="endShape != null and endShape != ''">
            t.end_shape = #{endShape},
        </if>
        <if test="washer != null">
            t.washer = #{washer},
        </if>
        <if test="washerType != null and washerType != ''">
            t.washer_type = #{washerType},
        </if>
        <if test="diameter != null and diameter != ''">
            t.diameter = #{diameter},
        </if>
        <if test="length != null and length != ''">
            t.length = #{length},
        </if>
        <if test="pitch != null and pitch != ''">
            t.pitch = #{pitch},
        </if>
        <if test="dentalForm != null and dentalForm != ''">
            t.dental_form = #{dentalForm},
        </if>
        <if test="strengthGrade != null and strengthGrade != ''">
            t.strength_grade = #{strengthGrade},
        </if>
        <if test="mechanicalProperty != null and mechanicalProperty != ''">
            t.mechanical_property = #{mechanicalProperty},
        </if>
        <if test="surfaceTreatment != null and surfaceTreatment != ''">
            t.surface_treatment = #{surfaceTreatment},
        </if>
        <if test="structureCharacter != null and structureCharacter != ''">
            t.structure_character = #{structureCharacter},
        </if>
        <if test="deviceForm != null and deviceForm != ''">
            t.device_form = #{deviceForm},
        </if>
        <if test="deviceCode != null and deviceCode != ''">
            t.device_code = #{deviceCode},
        </if>
        <if test="designer != null and designer != ''">
            t.designer = #{designer},
        </if>
        <if test="designerDept != null and designerDept != ''">
            t.designer_dept = #{designerDept},
        </if>
        <if test="nonRepairReason != null and nonRepairReason != ''">
            t.non_repair_reason = #{nonRepairReason},
        </if>
        <if test="colorRepair != null">
            t.color_repair = #{colorRepair},
        </if>
        <if test="primerRepair != null">
            t.primer_repair = #{primerRepair},
        </if>
        <if test="electrophoresisRepair != null">
            t.electrophoresis_repair = #{electrophoresisRepair},
        </if>
        <if test="productionCode != null and productionCode != ''">
            t.production_code = #{productionCode},
        </if>
        <if test="spareProperty != null and spareProperty != ''">
            t.spare_property = #{spareProperty},
        </if>
        <if test="saleNote != null and saleNote != ''">
            t.sale_note = #{saleNote},
        </if>
        <if test="firstProductionDate != null and firstProductionDate != ''">
            t.first_production_date = #{firstProductionDate},
        </if>
        <if test="initialModel != null and initialModel != ''">
            t.initial_model = #{initialModel},
        </if>
        <if test="description != null and description != ''">
            t.description = #{description},
        </if>
        <if test="modifyBy != null">
            t.modify_by = #{modifyBy},
        </if>
        t.row_version = t.row_version + 1,
        t.modify_time = now()
        WHERE id = #{id}
    </update>

    <!-- 逻辑删除 -->
    <update id="logicalDeletePo" parameterType="Long">
        UPDATE tb_part t SET
        t.row_version = t.row_version + 1,
        t.modify_time = now(),
        t.row_valid = 0
        WHERE t.id = #{value}
    </update>

    <!-- 物理删除 -->
    <delete id="physicalDeletePo" parameterType="Long">
        DELETE FROM tb_part t
        WHERE t.id = #{value}
    </delete>

    <!-- 批量物理删除 -->
    <delete id="batchPhysicalDeletePo" parameterType="Long">
        DELETE FROM tb_part t
        WHERE t.id IN
        <foreach collection="array" item="id" open="(" separator="," close=")">
            #{id}
        </foreach>
    </delete>

    <!-- 根据主键获取对应数据 -->
    <select id="selectPoById" parameterType="Long" resultMap="baseResultMap">
        SELECT <include refid="baseColumnList"/>
        FROM tb_part t
        WHERE t.id = #{value}
        AND t.row_valid = 1
    </select>

    <!-- 根据数据对象获取对应数据列表 -->
    <select id="selectPoByExample" parameterType="net.hwyz.iov.cloud.tsp.vmd.service.infrastructure.repository.po.PartPo" resultMap="baseResultMap">
        SELECT <include refid="baseColumnList"/>
        FROM tb_part t
        WHERE t.row_valid = 1
        <if test="id != null">
            AND t.id = #{id}
        </if>
        <if test="pn != null and pn != ''">
            AND t.pn = #{pn}
        </if>
        <if test="name != null and name != ''">
            AND t.name = #{name}
        </if>
        <if test="nameEn != null and nameEn != ''">
            AND t.name_en = #{nameEn}
        </if>
        <if test="type != null and type != ''">
            AND t.type = #{type}
        </if>
        <if test="ffa != null and ffa != ''">
            AND t.ffa = #{ffa}
        </if>
        <if test="status != null and status != ''">
            AND t.status = #{status}
        </if>
        <if test="digitalModel != null and digitalModel != ''">
            AND t.digital_model = #{digitalModel}
        </if>
        <if test="unit != null and unit != ''">
            AND t.unit = #{unit}
        </if>
        <if test="framePart != null">
            AND t.frame_part = #{framePart}
        </if>
        <if test="naturePart != null">
            AND t.nature_part = #{naturePart}
        </if>
        <if test="colorArea != null and colorArea != ''">
            AND t.color_area = #{colorArea}
        </if>
        <if test="naturePn != null and naturePn != ''">
            AND t.nature_pn = #{naturePn}
        </if>
        <if test="regulatoryPart != null">
            AND t.regulatory_part = #{regulatoryPart}
        </if>
        <if test="keyPart != null and keyPart != ''">
            AND t.key_part = #{keyPart}
        </if>
        <if test="accuratelyTraced != null">
            AND t.accurately_traced = #{accuratelyTraced}
        </if>
        <if test="aftersalePart != null">
            AND t.aftersale_part = #{aftersalePart}
        </if>
        <if test="standardPartClass != null and standardPartClass != ''">
            AND t.standard_part_class = #{standardPartClass}
        </if>
        <if test="wrenchType != null and wrenchType != ''">
            AND t.wrench_type = #{wrenchType}
        </if>
        <if test="rodType != null and rodType != ''">
            AND t.rod_type = #{rodType}
        </if>
        <if test="headShape != null and headShape != ''">
            AND t.head_shape = #{headShape}
        </if>
        <if test="endShape != null and endShape != ''">
            AND t.end_shape = #{endShape}
        </if>
        <if test="washer != null">
            AND t.washer = #{washer}
        </if>
        <if test="washerType != null and washerType != ''">
            AND t.washer_type = #{washerType}
        </if>
        <if test="diameter != null and diameter != ''">
            AND t.diameter = #{diameter}
        </if>
        <if test="length != null and length != ''">
            AND t.length = #{length}
        </if>
        <if test="pitch != null and pitch != ''">
            AND t.pitch = #{pitch}
        </if>
        <if test="dentalForm != null and dentalForm != ''">
            AND t.dental_form = #{dentalForm}
        </if>
        <if test="strengthGrade != null and strengthGrade != ''">
            AND t.strength_grade = #{strengthGrade}
        </if>
        <if test="mechanicalProperty != null and mechanicalProperty != ''">
            AND t.mechanical_property = #{mechanicalProperty}
        </if>
        <if test="surfaceTreatment != null and surfaceTreatment != ''">
            AND t.surface_treatment = #{surfaceTreatment}
        </if>
        <if test="structureCharacter != null and structureCharacter != ''">
            AND t.structure_character = #{structureCharacter}
        </if>
        <if test="deviceForm != null and deviceForm != ''">
            AND t.device_form = #{deviceForm}
        </if>
        <if test="deviceCode != null and deviceCode != ''">
            AND t.device_code = #{deviceCode}
        </if>
        <if test="designer != null and designer != ''">
            AND t.designer = #{designer}
        </if>
        <if test="designerDept != null and designerDept != ''">
            AND t.designer_dept = #{designerDept}
        </if>
        <if test="nonRepairReason != null and nonRepairReason != ''">
            AND t.non_repair_reason = #{nonRepairReason}
        </if>
        <if test="colorRepair != null">
            AND t.color_repair = #{colorRepair}
        </if>
        <if test="primerRepair != null">
            AND t.primer_repair = #{primerRepair}
        </if>
        <if test="electrophoresisRepair != null">
            AND t.electrophoresis_repair = #{electrophoresisRepair}
        </if>
        <if test="productionCode != null and productionCode != ''">
            AND t.production_code = #{productionCode}
        </if>
        <if test="spareProperty != null and spareProperty != ''">
            AND t.spare_property = #{spareProperty}
        </if>
        <if test="saleNote != null and saleNote != ''">
            AND t.sale_note = #{saleNote}
        </if>
        <if test="firstProductionDate != null and firstProductionDate != ''">
            AND t.first_production_date = #{firstProductionDate}
        </if>
        <if test="initialModel != null and initialModel != ''">
            AND t.initial_model = #{initialModel}
        </if>
        <if test="description != null and description != ''">
            AND t.description = #{description}
        </if>
        <if test="createTime != null">
            AND t.create_time = #{createTime}
        </if>
        <if test="createBy != null and createBy != ''">
            AND t.create_by = #{createBy}
        </if>
        <if test="modifyTime != null">
            AND t.modify_time = #{modifyTime}
        </if>
        <if test="modifyBy != null and modifyBy != ''">
            AND t.modify_by = #{modifyBy}
        </if>
        <if test="rowVersion != null">
            AND t.row_version = #{rowVersion}
        </if>
        ORDER BY t.id DESC
    </select>

    <!-- 根据Map对象获取对应数据列表 -->
    <select id="selectPoByMap" parameterType="java.util.Map" resultMap="baseResultMap">
        SELECT <include refid="baseColumnList"/>
        FROM tb_part t
        WHERE t.row_valid = 1
        <!-- 添加自定义条件 -->
        <if test="pn != null and pn != ''">
            AND t.pn LIKE #{pn}
        </if>
        <if test="name != null and name != ''">
            AND t.name LIKE #{name}
        </if>
        <if test="type != null and type != ''">
            AND t.type = #{type}
        </if>
        <if test="deviceCode != null and deviceCode != ''">
            AND t.device_code = #{deviceCode}
        </if>
        ORDER BY t.id DESC
    </select>

    <!-- 根据零件号查询零件信息 -->
    <select id="selectPoByPn" parameterType="java.util.Map" resultMap="baseResultMap">
        SELECT <include refid="baseColumnList"/>
        FROM tb_part t
        WHERE t.row_valid = 1
        AND t.pn = #{pn}
        LIMIT 1
    </select>

    <!-- 根据Map对象统计记录数 -->
    <select id="countPoByMap" parameterType="java.util.Map" resultType="int">
        SELECT COUNT(*)
        FROM tb_part t
        WHERE t.row_valid = 1
        <!-- 添加自定义条件 -->
    </select>
</mapper>
